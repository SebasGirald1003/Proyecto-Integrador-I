{% extends "base.html" %}
{% block content %}
    
<div class="container">
    <form action="">
        <div class="mb-3">
            <label for="searchBook" class="form-label">
                Search for a book:
            </label>
            <input type="text" class="form-control" name="searchBook" id="searchBook"/>
        </div>
        <button type="submit" class="btn btn-primary">Search</button>
    </form>
    <p>Searching for {{ searchTerm }}</p>
    <div class="row row-cols-1 row-cols-md-3 g-4">

        {% for book in books %}

        <div class="card mb-3" style="width: 18rem;">
            <div class="card-body">
                <h2 class="card-title">{{ book.title }}</h2>
                <h3 class="card-text">{{ book.author }}</h3>
                {% if book.available %}
                    <p>Available</p>
                {% else %}
                    <p>Rented until {{ book.availability }}</p>
                {% endif %}
                <img src="{{ book.image.url }}">
                <br>
                <a href="{% url 'book_description' book.id %}" class="btn btn-info">Description</a>
                
                <!-- Rating form -->
                <form method="POST" action="{% url 'rate_book' %}">
                    {% csrf_token %}
                    <input type="hidden" name="book_id" value="{{ book.id }}">
                    <style>
                        .rating {
                            display: inline-block;
                            unicode-bidi: bidi-override;
                            direction: rtl;
                        }

                        .rating input {
                            display: none;
                        }

                        .rating label {
                            display: inline-block;
                            padding: 5px;
                            font-size: 30px;
                        }

                        .rating label::before {
                            content: "\2605";
                        }

                        .rating input:checked ~ label {
                            color: #FFD700;
                        }
                    </style>
                    <div class="rating">
                        <input type="radio" id="star5_{{ book.id }}" name="rating" value="5">
                        <label for="star5_{{ book.id }}" title="5 stars"></label>
                        <input type="radio" id="star4_{{ book.id }}" name="rating" value="4">
                        <label for="star4_{{ book.id }}" title="4 stars"></label>
                        <input type="radio" id="star3_{{ book.id }}" name="rating" value="3">
                        <label for="star3_{{ book.id }}" title="3 stars"></label>
                        <input type="radio" id="star2_{{ book.id }}" name="rating" value="2">
                        <label for="star2_{{ book.id }}" title="2 stars"></label>
                        <input type="radio" id="star1_{{ book.id }}" name="rating" value="1">
                        <label for="star1_{{ book.id }}" title="1 star"></label>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit rating</button>
                </form>
                
                <p>Rating average: {{ book.rating_average }}</p>
                
                {% comment %} <a href="{% url 'adminrent' book.id %}" class="btn btn-info">Admin</a> {% endcomment %}

            </div>
        </div>
        &nbsp;&nbsp;&nbsp;

        {% endfor %}

    </div>
</div>
</body>
</html>

{% endblock content %}